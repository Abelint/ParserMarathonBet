(LiveUpdateSettingsHelper=function(){this.currentAjaxReq=null;var i=0;this.UPDATE_REQUEST_TIMEOUT=18e4,this.UPDATE_SETTINGS_URL="/settings/lusettings.htm",this.timerId=null,this.Init=function(){var e=this;StompManager.subscribe(initData.stomp.liveUpdateSettingsChangesDestination,function(t){e.processSettings(JSON.parse(t.body))}),this.startLiveUpdateSettingsPolling()},this.startLiveUpdateSettingsPolling=function(){var t=this.sendRequest.bind(this);this.timerId=window.setTimeout(t,initData.liveUpdateSettingsInterval)},this.stopLiveUpdateSettingsPolling=function(){clearTimeout(this.timerId),this.timerId=null},this.sendRequest=function(){var e=this;this.currentAjaxReq=$.ajax({type:"POST",url:initData.base_dir+this.UPDATE_SETTINGS_URL,dataType:"JSON",data:{updated:i},timeout:e.UPDATE_REQUEST_TIMEOUT,success:function(t){e.currentAjaxReq=null,e.successResult(t)},error:function(t){e.currentAjaxReq=null;try{e.errorResult(t.status)}catch(t){e.errorResult(500)}}})},this.successResult=function(t){this.processSettings(t),this.startLiveUpdateSettingsPolling()},this.errorResult=function(t){102!=t&&this.startLiveUpdateSettingsPolling()},this.processSettings=function(t){t&&(t.liveUpdateDomain&&(initData.liveUpdateDomain=t.liveUpdateDomain),t.liveUpdateTransport&&(initData.liveUpdateTransport=t.liveUpdateTransport),t.updateInterval&&(initData.update_interval=t.updateInterval),t.updated)&&(i=t.updated)},$(document).on("websocket.connection.change",function(t,e){var i=getLiveUpdateSettingsHelper();"CONNECTED"===e?i.stopLiveUpdateSettingsPolling():i.timerId||i.startLiveUpdateSettingsPolling()})})._instance=null,getLiveUpdateSettingsHelper=function(){return LiveUpdateSettingsHelper._instance||(LiveUpdateSettingsHelper._instance=new LiveUpdateSettingsHelper),LiveUpdateSettingsHelper._instance};
//# sourceMappingURL=LiveUpdateSettingsHelperClass.map